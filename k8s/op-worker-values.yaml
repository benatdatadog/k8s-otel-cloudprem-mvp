# Observability Pipelines Worker Helm Values
# Used with: helm upgrade --install opw datadog/observability-pipelines-worker
#
# Prerequisites:
# 1. Create Pipeline in Datadog UI (https://app.datadoghq.com/observability-pipelines)
# 2. Configure Source: OpenTelemetry
# 3. Configure Destination: Datadog Logs â†’ http://cloudprem-indexer.cloudprem.svc.cluster.local:7280
# 4. Deploy and copy Pipeline ID to .env as DD_OP_PIPELINE_ID

# Service configuration - expose OTLP ports for OTEL Collector
service:
  ports:
    - name: otlp-grpc
      protocol: TCP
      port: 4317
      targetPort: 4317
    - name: otlp-http
      protocol: TCP
      port: 4318
      targetPort: 4318

# Environment variables for OP Worker
# These configure the OTLP source endpoints
env:
  - name: DD_OP_SOURCE_OTLP_GRPC_ADDRESS
    value: "0.0.0.0:4317"
  - name: DD_OP_SOURCE_OTLP_HTTP_ADDRESS
    value: "0.0.0.0:4318"

# Resource limits
resources:
  requests:
    memory: "256Mi"
    cpu: "100m"
  limits:
    memory: "512Mi"
    cpu: "500m"

# Note: datadog.apiKey, datadog.pipelineId, datadog.site
# are passed via --set in setup.sh from environment variables
